<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml" >
<head>
    <meta charset="utf-8">
    <title>Tranverra - Form</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Google Web Fonts (CDN – OK) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;0,900;1,400;1,700;1,900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet (CDN) -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css">

    <!-- Libraries Stylesheet (LOCAL – JAR safe) -->
    <link rel="stylesheet" th:href="@{/lib/animate/animate.min.css}">
    <link rel="stylesheet" th:href="@{/lib/owlcarousel/assets/owl.carousel.min.css}">

    <!-- Bootstrap Stylesheet (LOCAL) -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">

    <!-- Template Stylesheet (LOCAL) -->
    <link rel="stylesheet" th:href="@{/css/style.css}">



</head>
<style>
    @media (max-width: 768px) {
        .carousel-item {
            min-height: auto !important;
        }
    }

    /* SUCCESS POPUP */
    .popup-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.3);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 9999;
    }

    .popup-box {
        background: #fff;
        padding: 20px 25px;
        border-radius: 10px;
        text-align: center;
        width: 280px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .popup-box h6 {
        margin-bottom: 8px;
    }

    .popup-box p {
        font-size: 14px;
        color: #555;
    }

    .popup-box button {
        margin-top: 12px;
        padding: 6px 20px;
        border: none;
        background: #198754;
        color: #fff;
        border-radius: 6px;
        cursor: pointer;
    }
</style>


<body>
<div th:insert="@{UserHeader}"></div>
<!-- Carousel Start -->
<div class="header-carousel" th:fragment="formfully">
    <div id="carouselId" class="carousel slide" data-bs-ride="carousel" data-bs-interval="false">
        <ol class="carousel-indicators">
            <li data-bs-target="#carouselId" data-bs-slide-to="0" class="active" aria-current="true" aria-label="First slide"></li>
            <li data-bs-target="#carouselId" data-bs-slide-to="1" aria-label="Second slide"></li>
        </ol>
        <div class="carousel-inner" role="listbox">
            <div class="carousel-item active">
                <img src="img/carousel-2.jpg" class="img-fluid w-120" alt="First slide"/>
                <div class="carousel-caption">
                    <div class="container py-5" style="padding-left:0; padding-right:0;transform: translateY(-40px);">
                        <div class="col-lg-7 col-md-10 mx-auto fadeInUp animated text-start"
                             data-animation="fadeInLeft"
                             data-delay="1s"
                             style="animation-delay: 1s;">

                            <div class="bg-secondary rounded p-5">
                                <h4 class="text-white mb-3">BOOK YOUR JOURNEY</h4>
<!--                                success massege-->
                                <div th:if="${successMessage}" class="alert alert-success">
                                    <span th:text="${successMessage}"></span>
                                </div>

                                <form th:action="@{/home}" method="post" th:object="${bookingform}" id="bookingForm">
                                    <div class="row g-3">

                                        <!-- Full Name -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-user"></span><span class="ms-1">Full Name</span>
                                                </div>
                                                <input class="form-control form-control-sm" type="text"
                                                       placeholder="Enter your full name"
                                                       th:field="*{username}" required>
                                            </div>
                                        </div>

                                        <!-- Email -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-envelope"></span><span class="ms-1">Email</span>
                                                </div>

                                                <input class="form-control form-control-sm"
                                                       type="email"
                                                       id="emailInput"
                                                       placeholder="Enter your Gmail address"
                                                       th:field="*{email}"
                                                       pattern="^[a-zA-Z0-9._%+-]+@gmail\.com$"
                                                       title="Please enter a valid Gmail address ending with @gmail.com"
                                                       required>
                                            </div>
                                            <small id="emailError" class="text-danger d-none">
                                                Please enter a valid Gmail address (example@gmail.com)
                                            </small>

                                        </div>

                                        <!-- Mobile -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-phone-alt"></span><span class="ms-1">Mobile</span>
                                                </div>
                                                <input class="form-control form-control-sm" type="tel"
                                                       placeholder="Enter mobile number"
                                                       th:field="*{phoneNo}" required>
                                            </div>
                                        </div>

                                        <!-- Trip Request Date -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-calendar-alt"></span><span class="ms-1">Request Date</span>
                                                </div>
                                                <input id="tripRequestDate"
                                                       type="date"
                                                       class="form-control form-control-sm"
                                                       value="(model value)"
                                                       th:field="*{tripReqDate}" readonly>
                                            </div>
                                        </div>

                                        <!-- Trip Type (Full Width) -->
                                        <div class="col-12">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-2 small fw-normal">
                                                    <span class="fas fa-route"></span><span class="ms-1">Trip Type</span>
                                                </div>
                                                <select id="tripType1" class="form-control form-control-sm" th:field="*{tripType}">
                                                    <option value="">--- Select ---</option>
                                                    <option value="OWT">One Way Transfer</option>
                                                    <option value="RT">Return Transfer</option>
                                                    <option value="AA">Airport Arrival</option>
                                                    <option value="AD">Airport Departure</option>
                                                    <option value="HS">Half Day</option>
                                                    <option value="FS">Full Day</option>
                                                    <option value="H24">24 Hours</option>
                                                </select>
                                            </div>
                                        </div>

                                      <!-- One Way Transfer -->
                                      <div id="onewayFields1" class="row g-3">

                                            <!-- Date -->
                                            <div class="col-md-6">
                                                <div class="input-group">
                                                    <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                        <span class="fas fa-calendar-alt"></span>
                                                        <span class="ms-1">Date</span>
                                                    </div>
                                                    <input id="formOnedate1" name="formOnedate1"
                                                           type="date"
                                                           class="form-control form-control-sm"
                                                           th:field="*{oneWayDate}"
                                                           required>
                                                </div>
                                            </div>

                                            <!-- Pick Up Time -->
                                            <div class="col-md-6">
                                                <div class="input-group">
                                                    <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                        <span class="fas fa-clock"></span>
                                                        <span class="ms-1">Pick-up Time</span>
                                                    </div>
                                                    <input type="time"
                                                           class="form-control form-control-sm"
                                                           th:field="*{oneWayPickupTime}"
                                                           required>
                                                </div>
                                            </div>

                                            <!-- Pickup Location -->
                                            <div class="col-md-12">
                                                <div class="input-group">
                                                    <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                        <span class="fas fa-map-marker-alt"></span>
                                                        <span class="ms-1"> Pick-Up Location </span>
                                                    </div>
                                                    <input id="oneWayPickUp"
                                                           type="text"
                                                           class="form-control form-control-sm"
                                                           placeholder="Enter pick-up location"
                                                           th:field="*{oneWayPickUp}"
                                                           autocomplete="off"
                                                           required>
                                                </div>
                                                    <div id="oneWayPickUpSuggestions"
                                                         class="list-group position-absolute w-100 shadow"
                                                         style="z-index:1000;"></div>
                                            </div>

                                            <!-- Drop-off Location -->
                                            <div class="col-md-12">
                                                <div class="input-group">
                                                    <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                        <span class="fas fa-map-marker-alt"></span>
                                                        <span class="ms-1">Drop-off Location</span>
                                                    </div>
                                                    <input id="oneWayDropOff"
                                                           type="text"
                                                           class="form-control form-control-sm"
                                                           placeholder="Enter drop-off location"
                                                           th:field="*{oneWayDropOff}"
                                                           autocomplete="off"
                                                           required>
                                                </div>
                                                <div id="oneWayDropOffSuggestions"
                                                     class="list-group position-absolute w-100 shadow"
                                                     style="z-index:1000;"></div>
                                            </div>

                                            <!-- Passengers -->
                                            <div class="col-md-6">
                                                <div class="input-group">
                                                    <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                        <span class="fas fa-users"></span>
                                                        <span class="ms-1">No. of Passengers</span>
                                                    </div>
                                                    <input type="number"
                                                           min="1"
                                                           step="1"
                                                           class="form-control form-control-sm"
                                                           th:field="*{oneWayTravellersCount}"
                                                           required>
                                                </div>
                                                <!-- Validation message -->
                                                <small id="travellerError" class="text-danger d-none">
                                                    0 travellers is not allowed
                                                </small>
                                            </div>

                                            <!-- Vehicle Type -->
                                            <div class="col-md-6">
                                                <div class="input-group">
                                                    <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                        <span class="fas fa-car"></span>
                                                        <span class="ms-1">Vehicle Type</span>
                                                    </div>
                                                    <select class="form-select form-select-sm"
                                                            th:field="*{oneWayVehicleType}"
                                                            required>
                                                        <option value="">Select Vehicle</option>
                                                        <option th:each="v : ${vehicleTypes}"
                                                                th:value="${v}"
                                                                th:text="${v}">
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>

                                            <!-- Special Requests (Full Width) -->
                                            <div class="col-12">
                                                <div class="input-group">
                                                    <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                        <span class="fas fa-edit"></span>
                                                        <span class="ms-1">Special Requests (Optional)</span>
                                                    </div>
                                                    <textarea class="form-control form-control-sm"
                                                              rows="2"
                                                              placeholder="Type your request..."
                                                              th:field="*{oneWaySpecialReq}">
                                                    </textarea>
                                                </div>
                                            </div>
                                        </div>
                                      <!--Return Transfer-->
                                      <div id="returnFields1" class="row g-3 d-none">

                                        <!-- Date -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-calendar-alt"></span>
                                                    <span class="ms-1">Date</span>
                                                </div>
                                                <input id="formOnedate2" name="formOnedate2"
                                                       type="date"
                                                       class="form-control form-control-sm"
                                                       th:field="*{returnDate}">
                                            </div>
                                        </div>

                                        <!-- Pick Up Time -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-clock"></span>
                                                    <span class="ms-1">Pick-up Time</span>
                                                </div>
                                                <input type="time"
                                                       class="form-control form-control-sm"
                                                       th:field="*{retPickUpTime}">
                                            </div>
                                        </div>

                                        <!-- Pickup Location -->
                                        <div class="col-md-12">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-map-marker-alt"></span>
                                                    <span class="ms-1">Pick-Up Location</span>
                                                </div>
                                                <input id="returnPickUp"
                                                       type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Enter pick-up location"
                                                       th:field="*{returnPickUp}"
                                                       autocomplete="off">
                                            </div>
                                                <div id="returnPickUpSuggestions"
                                                     class="list-group position-absolute w-100 shadow"
                                                     style="z-index:1000;"></div>
                                        </div>

                                        <!-- Drop-off Location -->
                                        <div class="col-md-12">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-map-marker-alt"></span>
                                                    <span class="ms-1">Drop-off Location</span>
                                                </div>
                                                <input id="returnDropOff"
                                                       type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Enter drop-off location"
                                                       th:field="*{returnDropOff}"
                                                       autocomplete="off">
                                            </div>
                                            <div id="returnDropOffSuggestions"
                                                 class="list-group position-absolute w-100 shadow"
                                                 style="z-index:1000;"></div>
                                        </div>
                                        <!--return pick-up location-->
                                        <div class="col-md-12">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-2 small fw-normal">
                                                    <span class="fas fa-map-marker-alt"></span>
                                                    <span class="ms-1">Return Location</span>
                                                </div>
                                                <input id="returnPickUpLocation"
                                                       type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Enter drop-off location"
                                                       th:field="*{returnPickUpLocation}"
                                                       autocomplete="off">
                                            </div>
                                                <div id="returnPickingUpSuggestions"
                                                     class="list-group position-absolute w-100 shadow"
                                                     style="z-index:1000;"></div>
                                        </div>
                                        <!-- Return Time -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-clock"></span>
                                                    <span class="ms-1">Pick-up Time</span>
                                                </div>
                                                <input type="time"
                                                       class="form-control form-control-sm"
                                                       th:field="*{returnTime}">
                                            </div>
                                        </div>
                                        <!-- Passengers -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-users"></span>
                                                    <span class="ms-1">No. of Passengers</span>
                                                </div>
                                                <input type="number"
                                                       min="1"
                                                       step="1"
                                                       class="form-control form-control-sm"
                                                       th:field="*{returnTravellersCount}">
                                            </div>
                                        </div>

                                        <!-- Vehicle Type -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-car"></span>
                                                    <span class="ms-1">Vehicle Type</span>
                                                </div>

                                                <select class="form-select form-control-sm"
                                                        th:field="*{returnVehicleType}">
                                                    <option value="">Select Vehicle</option>
                                                    <option th:each="v : ${vehicleTypes}"
                                                            th:value="${v}"
                                                            th:text="${v}">
                                                    </option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Special Requests (Full Width) -->
                                        <div class="col-12">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-2 small fw-normal">
                                                    <span class="fas fa-edit"></span>
                                                    <span class="ms-1">Special Requests (Optional)</span>
                                                </div>
                                                <textarea class="form-control form-control-sm"
                                                          rows="2"
                                                          placeholder="Type your request..."
                                                          th:field="*{returnSpecialReq}">
                                                </textarea>
                                            </div>
                                        </div>
                                    </div>
                                      <!-- Airport Arrival -->
                                      <div id="arrivalFields1" class="row g-3 d-none">

                                        <!-- Airport Name -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-plane-arrival"></span>
                                                    <span class="ms-1">Airport Name</span>
                                                </div>
                                                <input id="arriveAirportName"
                                                        type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Enter airport name"
                                                       th:field="*{arriveAirportName}">
<!--                                                       autocomplete="off"-->

                                            </div>
                                        </div>

                                        <!-- Terminal -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-building"></span>
                                                    <span class="ms-1">Terminal</span>
                                                </div>
                                                <input type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Terminal"
                                                       th:field="*{arriveTerminal}">
                                            </div>
                                        </div>

                                        <!-- Arrival Time -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-clock"></span>
                                                    <span class="ms-1">Arrival Time</span>
                                                </div>
                                                <input type="time"
                                                       class="form-control form-control-sm"
                                                       th:field="*{arrivalTime}">
                                            </div>
                                        </div>

                                        <!-- Flight No -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-plane"></span>
                                                    <span class="ms-1">Flight No</span>
                                                </div>
                                                <input type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Flight number"
                                                       th:field="*{arriveFlightNo}">
                                            </div>
                                        </div>

                                        <!-- Drop-off Location -->
                                        <div class="col-md-12">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-map-marker-alt"></span>
                                                    <span class="ms-1">Drop-off Location</span>
                                                </div>
                                                <input id="arriveDropOff"
                                                       type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Enter drop-off location"
                                                       th:field="*{arriveDropOff}"
                                                       autocomplete="off">
                                            </div>
                                            <div id="arriveDropOffSuggestions"
                                                 class="list-group position-absolute w-100 shadow"
                                                 style="z-index:1000;"></div>
                                        </div>
                                          <!-- Date -->
                                          <div class="col-md-6">
                                              <div class="input-group">
                                                  <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                      <span class="fas fa-calendar-alt"></span>
                                                      <span class="ms-1">Date</span>
                                                  </div>
                                                  <input id="formOnedate3" name="formOnedate3"
                                                         type="date"
                                                         class="form-control form-control-sm"
                                                         th:field="*{arrivalDate}"
                                                         required>
                                              </div>
                                          </div>
                                        <!-- Passengers -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-users"></span>
                                                    <span class="ms-1">No. of Passengers</span>
                                                </div>
                                                <input type="number"
                                                       min="1"
                                                       step="1"
                                                       class="form-control form-control-sm"
                                                       th:field="*{arriveTravellersCount}">
                                            </div>
                                        </div>

                                        <!-- Vehicle Type -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-car"></span>
                                                    <span class="ms-1">Vehicle Type</span>
                                                </div>
                                                <select class="form-select form-select-sm"
                                                        th:field="*{arriveVehicleType}">
                                                    <option value="">Select Vehicle</option>
                                                    <option th:each="v : ${vehicleTypes}"
                                                            th:value="${v}"
                                                            th:text="${v}">
                                                    </option>
                                                </select>
                                            </div>
                                        </div>

                                    </div>
                                      <!-- Airport Departure -->
                                      <div id="departureFields1" class="row g-3 d-none">

                                        <!-- Pick-up Location -->
                                        <div class="col-md-12">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-map-marker-alt"></span>
                                                    <span class="ms-1">Pick-Up Location</span>
                                                </div>
                                                <input id="departPickUp"
                                                        type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Enter pick-up location"
                                                       th:field="*{departPickUp}"
                                                       autocomplete="off"
                                                       required>
                                            </div>
                                                <div id="departurePickUpSuggestions"
                                                     class="list-group position-absolute w-100 shadow"
                                                     style="z-index:1000;"></div>
                                        </div>

                                        <!-- Pick-up Time -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-clock"></span>
                                                    <span class="ms-1">Pick-up Time</span>
                                                </div>
                                                <input type="time"
                                                       class="form-control form-control-sm"
                                                       th:field="*{departPickupTime}"
                                                       required>
                                            </div>
                                        </div>

                                        <!-- Airport Name -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-plane-departure"></span>
                                                    <span class="ms-1">Airport Name</span>
                                                </div>
                                                <input id="departAirportName"
                                                        type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Enter airport name"
                                                       th:field="*{departAirportName}"required>
<!--                                                       autocomplete="off"-->

                                            </div>
                                        </div>

                                        <!-- Terminal -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-building"></span>
                                                    <span class="ms-1">Terminal</span>
                                                </div>
                                                <input type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Terminal"
                                                       th:field="*{departTerminal}"
                                                       required>
                                            </div>
                                        </div>

                                        <!-- Flight Number -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-plane"></span>
                                                    <span class="ms-1">Flight No</span>
                                                </div>
                                                <input type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Enter flight number"
                                                       th:field="*{departFlightNo}"
                                                       required>
                                            </div>
                                        </div>
                                          <!-- Date -->
                                          <div class="col-md-6">
                                              <div class="input-group">
                                                  <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                      <span class="fas fa-calendar-alt"></span>
                                                      <span class="ms-1">Date</span>
                                                  </div>
                                                  <input id="formOnedate4" name="formOnedate4"
                                                         type="date"
                                                         class="form-control form-control-sm"
                                                         th:field="*{departDate}"
                                                         required>
                                              </div>
                                          </div>
                                        <!-- Passengers -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-users"></span>
                                                    <span class="ms-1">No. of Passengers</span>
                                                </div>
                                                <input type="number"
                                                       min="1"
                                                       step="1"
                                                       class="form-control form-control-sm"
                                                       th:field="*{departTravellersCount}"
                                                       required>
                                            </div>
                                        </div>

                                        <!-- Vehicle Type -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-2 small fw-normal">
                                                    <span class="fas fa-car"></span>
                                                    <span class="ms-1">Vehicle Type</span>
                                                </div>
                                                <select class="form-select form-select-sm"
                                                        th:field="*{departVehicleType}"
                                                        required>
                                                    <option value="">Select Vehicle</option>
                                                    <option th:each="v : ${vehicleTypes}"
                                                            th:value="${v}"
                                                            th:text="${v}">
                                                    </option>
                                                </select>
                                            </div>
                                        </div>

                                    </div>
                                      <!-- Day Service : Half Day / Full Day / 24 Hours -->
                                      <div id="dayServiceFields1" class="row g-3 d-none">

                                        <!-- Pick-up Location -->
                                        <div class="col-md-12">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-map-marker-alt"></span>
                                                    <span class="ms-1">Pick-Up Location</span>
                                                </div>
                                                <input id="dayTripPickUp"
                                                        type="text"
                                                       class="form-control form-control-sm"
                                                       placeholder="Enter pick-up location"
                                                       th:field="*{dayTripPickUp}"
                                                       autocomplete="off"
                                                       required>
                                            </div>
                                            <div class="position-relative">
                                                <div id="dayTripsPickUpSuggestions"
                                                     class="list-group position-absolute w-100 shadow"
                                                     style="z-index:1000;"></div>
                                            </div>
                                        </div>

                                        <!-- Start Time -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-clock"></span>
                                                    <span class="ms-1">Start Time</span>
                                                </div>
                                                <input type="time"
                                                       class="form-control form-control-sm"
                                                       th:field="*{startTime}"
                                                       required>
                                            </div>
                                        </div>

                                        <!-- End Time -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-clock"></span>
                                                    <span class="ms-1">End Time</span>
                                                </div>
                                                <input type="time"
                                                       class="form-control form-control-sm"
                                                       th:field="*{endTime}"
                                                       required>
                                            </div>
                                        </div>
                                          <!-- Date -->
                                          <div class="col-md-6">
                                              <div class="input-group">
                                                  <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                      <span class="fas fa-calendar-alt"></span>
                                                      <span class="ms-1">Date</span>
                                                  </div>
                                                  <input id="formOnedate5" name="formOnedate5"
                                                         type="date"
                                                         class="form-control form-control-sm"
                                                         th:field="*{dayTripDate}"
                                                         required>
                                              </div>
                                          </div>
                                        <!-- Passengers -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-users"></span>
                                                    <span class="ms-1">No. of Passengers</span>
                                                </div>
                                                <input type="number"
                                                       min="1"
                                                       step="1"
                                                       class="form-control form-control-sm"
                                                       th:field="*{dayTripTravellersCount}"
                                                       required>
                                            </div>
                                        </div>

                                        <!-- Vehicle Type -->
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-1 small fw-normal">
                                                    <span class="fas fa-car"></span>
                                                    <span class="ms-1">Vehicle Type</span>
                                                </div>
                                                <select class="form-select form-select-sm"
                                                        th:field="*{dayTripVehicleType}"
                                                        required>
                                                    <option value="">-- Select Vehicle --</option>
                                                    <option th:each="v : ${vehicleTypes}"
                                                            th:value="${v}"
                                                            th:text="${v}">
                                                    </option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Itinerary (Full Width) -->
                                        <div class="col-12">
                                            <div class="input-group">
                                                <div class="d-flex align-items-center bg-light text-body rounded-start p-2 small fw-normal">
                                                    <span class="fas fa-map"></span>
                                                    <span class="ms-1">Itinerary (Optional)</span>
                                                </div>
                                                <textarea class="form-control form-control-sm"
                                                          rows="3"
                                                          placeholder="Enter itinerary details (optional)"
                                                          th:field="*{itinerary}">
                                                </textarea>
                                            </div>
                                        </div>
                                    </div>

                                      <div class="row align-items-center mt-3">

                                        <!-- Trip Rate -->
                                        <div class="col-md-6 col-12 text-md-start text-center mb-3 mb-md-0">
                                            <div class="fw-semibold text-muted small">
                                                Estimated Trip Rate
                                            </div>
                                            <div class="fw-bold text-success fs-3">
                                                <span id="tripRate">AED 0</span>
                                            </div>
                                        </div>

                                        <!-- Book Button -->
                                        <div class="col-md-6 col-12 text-md-end text-center">
                                            <button class="btn btn-light px-5 py-2 fw-semibold" type="submit">
                                                Book Now
                                            </button>
                                        </div>
                                      </div>
                                      <input type="hidden" id="rateInput" th:field="*{tripRate}">
                                   </div>
                                </form>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Carousel End -->

<!-- Modal (Booking Success - Dark Blue Theme) -->
<div class="modal fade" id="bookingSuccessModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <!-- Dark Blue Header -->
            <div class="modal-header" style="background-color:#052c65;">
                <h5 class="modal-title" style="color:#ffffff;">Booking Successful</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>

            <!-- Body -->
            <div class="modal-body text-center">
                <p>Your booking request has been submitted successfully.</p>
                <p class="text-muted">Our team will contact you shortly.</p>
            </div>

            <!-- Dark Blue Button -->
            <div class="modal-footer justify-content-center">
                <button id="bookingSuccessOk"
                        type="button"
                        class="btn"
                        style="background-color:#051736; color:white;"
                        data-bs-dismiss="modal">
                    OK
                </button>
            </div>

        </div>
    </div>
</div>


<!-- Back to Top -->
<a href="#" class="btn btn-secondary btn-lg-square rounded-circle back-to-top"><i class="fa fa-arrow-up"></i></a>

<div th:insert="@{UserFooter}"></div>

<!-- JavaScript Libraries (CDN) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- JavaScript Libraries (LOCAL – JAR safe) -->
<script th:src="@{/lib/wow/wow.min.js}"></script>
<script th:src="@{/lib/easing/easing.min.js}"></script>
<script th:src="@{/lib/waypoints/waypoints.min.js}"></script>
<script th:src="@{/lib/counterup/counterup.min.js}"></script>
<script th:src="@{/lib/owlcarousel/owl.carousel.min.js}"></script>

<!-- Template Javascript (LOCAL) -->
<script th:src="@{/js/main.js}"></script>

<!--Trip Request Date-->
    <script>
document.addEventListener("DOMContentLoaded", function () {
    const tripRequestDate = document.getElementById("tripRequestDate");
    if (tripRequestDate) {
        tripRequestDate.value = new Date().toISOString().split("T")[0];
        tripRequestDate.readOnly = true;
    }
});
</script>


<!--Date on future-->
<script>
    document.addEventListener("DOMContentLoaded", function () {

        const today = new Date().toISOString().split("T")[0];

        document.querySelectorAll(".future-date").forEach(input => {
            input.min = today;

            input.addEventListener("change", function () {
                if (this.value < today) {
                    alert("Please select a future date.");
                    this.value = today;
                }
            });
        });

    });
</script>
<!--Autosuggestion of places-->
<script>
    async function searchLocation(query) {
        if (query.length < 3) return [];

        const url =
`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&accept-language=en&limit=5`;


        const response = await fetch(url, {
            headers: {
                "Accept": "application/json"
            }
        });

        return response.json();
    }

    function setupAutocomplete(inputId, suggestionBoxId) {
        const input = document.getElementById(inputId);
        const suggestionBox = document.getElementById(suggestionBoxId);

        let index = -1; // current highlighted index for keyboard navigation

        function highlight(list) {
            list.forEach(i => i.classList.remove('active'));
            if (index >= 0 && list[index]) list[index].classList.add('active');
        }

        // generate suggestions on input
        input.addEventListener("input", async function () {
            const query = this.value;
            suggestionBox.innerHTML = "";
            index = -1; // reset when new suggestions arrive

            if (query.length < 3) return;

            const results = await searchLocation(query);

            results.forEach(place => {
                const item = document.createElement("button");
                item.type = "button";
                // add a shared class 'autocomplete-item' so keyboard navigation code can find these items
                item.className = "list-group-item list-group-item-action autocomplete-item";
                item.textContent = place.display_name;

                // use mousedown instead of click to avoid race with input blur which may clear the box
                item.addEventListener('mousedown', (ev) => {
                    ev.preventDefault();
                    input.value = place.display_name;
                    suggestionBox.innerHTML = "";
                });

                suggestionBox.appendChild(item);
            });
        });

        // handle arrow keys and enter on the input (attach once)
        input.addEventListener('keydown', function (e) {
            const list = suggestionBox.querySelectorAll('.autocomplete-item');
            if (!list.length) return;

            if (e.key === 'ArrowDown') {
                e.preventDefault();
                index = (index + 1) % list.length;
                highlight(list);
                list[index].scrollIntoView({ block: 'nearest' });
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                index = (index - 1 + list.length) % list.length;
                highlight(list);
                list[index].scrollIntoView({ block: 'nearest' });
            } else if (e.key === 'Enter') {
                if (index >= 0) {
                    e.preventDefault();
                    const sel = list[index];
                    input.value = sel.textContent;
                    suggestionBox.innerHTML = '';
                    index = -1;
                }
            }
        });

        // Close dropdown when clicking outside
        document.addEventListener("click", function (e) {
            // don't close when clicking inside the input or the suggestion box itself
            if (!input.contains(e.target) && !suggestionBox.contains(e.target)) {
                suggestionBox.innerHTML = "";
            }
        });
    }
</script>

<!--to set up autocomplete for specific IDs-->
<script>
<!--  SELECT PLACES  DOWN UP ARROW AND ENTER-->
    document.addEventListener("DOMContentLoaded", function () {
<!--FOLLOWING FOR AUTO COMPLTE-->
        setupAutocomplete("oneWayPickUp", "oneWayPickUpSuggestions");
        setupAutocomplete("oneWayDropOff", "oneWayDropOffSuggestions");
        setupAutocomplete("returnPickUp", "returnPickUpSuggestions");
        setupAutocomplete("returnDropOff", "returnDropOffSuggestions");
        setupAutocomplete("returnPickUpLocation", "returnPickingUpSuggestions");
        setupAutocomplete("arriveDropOff", "arriveDropOffSuggestions");
        setupAutocomplete("departPickUp", "departurePickUpSuggestions");
        setupAutocomplete("dayTripPickUp", "dayTripsPickUpSuggestions");
    });
</script>

</body>
</html>
<!--fields generation based on selection of trip type-->
<script>
    document.addEventListener("DOMContentLoaded", function () {

        function setupTripType(formNo) {

            const tripType = document.getElementById("tripType" + formNo);
            if (!tripType) {
                console.error("tripType" + formNo + " NOT FOUND!");
                return;
            }

            const oneway     = document.getElementById("onewayFields" + formNo);
            const ret        = document.getElementById("returnFields" + formNo);
            const arrival    = document.getElementById("arrivalFields" + formNo);
            const departure  = document.getElementById("departureFields" + formNo);
            const dayService = document.getElementById("dayServiceFields" + formNo);

            const today = new Date().toISOString().split("T")[0];

            function toggle(div, show) {
                if (!div) return;

                const inputs = div.querySelectorAll("input, select, textarea");

                if (show) {
                    div.classList.remove("d-none");

                    inputs.forEach(i => {
                        i.removeAttribute("disabled");

                        // ✅ Future dates only
                        if (i.type === "date") {
                            i.min = today;
                        }

                        // ✅ Make required EXCEPT optional textareas
                        if (
                            i.tagName !== "TEXTAREA" &&
                            !i.hasAttribute("data-optional")
                        ) {
                            i.setAttribute("required", true);
                        }
                    });

                } else {
                    div.classList.add("d-none");

                    inputs.forEach(i => {
                        i.setAttribute("disabled", "disabled");
                        i.removeAttribute("required");
                    });
                }
            }

            // Hide all initially
            toggle(oneway, false);
            toggle(ret, false);
            toggle(arrival, false);
            toggle(departure, false);
            toggle(dayService, false);

            // Change handler
            tripType.addEventListener("change", function () {

                toggle(oneway, false);
                toggle(ret, false);
                toggle(arrival, false);
                toggle(departure, false);
                toggle(dayService, false);

                switch (this.value) {
                    case "OWT":
                        toggle(oneway, true);
                        break;
                    case "RT":
                        toggle(ret, true);
                        break;
                    case "AA":
                        toggle(arrival, true);
                        break;
                    case "AD":
                        toggle(departure, true);
                        break;
                    case "HS":
                    case "FS":
                    case "H24":
                        toggle(dayService, true);
                        break;
                }
            });
        }

        // ✅ INIT FORM 1
        setupTripType(1);

    });
</script>


<!--Autogeneration of Trip rate before booking-->
<script>
    document.addEventListener("DOMContentLoaded", function () {

        const tripType = document.getElementById("tripType1");

        if (!tripType) {
            console.error("tripType1 element not found");
            return;
        }

        tripType.addEventListener("change", function () {
            const type = this.value;

            if (type) {
                fetch(`/trip/rate?tripType=${type}`)
                    .then(res => res.text())
                    .then(rate => {
                        document.getElementById("tripRate").innerText = "AED " + rate;
                        document.getElementById("rateInput").value = rate;
                    });
            }
        });

    });
</script>
<!--Success Modal instead of redirecting the page -->
<script>
    document.getElementById("bookingForm").addEventListener("submit", function (e) {
        e.preventDefault(); // 🚫 stop normal submit

        const formData = new FormData(this);

        // Attempt to read CSRF token/meta if present (Spring Security) and include in headers
        const headers = new Headers();
        headers.append('X-Requested-With', 'XMLHttpRequest');
        const csrfTokenMeta = document.querySelector('meta[name="_csrf"]');
        const csrfHeaderMeta = document.querySelector('meta[name="_csrf_header"]');
        if (csrfTokenMeta) {
            const token = csrfTokenMeta.getAttribute('content');
            const headerName = (csrfHeaderMeta ? csrfHeaderMeta.getAttribute('content') : 'X-CSRF-TOKEN');
            headers.append(headerName, token);
        }

        fetch("/home", {
            method: "POST",
            headers: headers,
            body: formData
        })
        .then(res => res.text())
        .then(result => {
            if (result === "SUCCESS") {
                // show bootstrap modal
                const modalEl = document.getElementById('bookingSuccessModal');
                const modal = new bootstrap.Modal(modalEl);
                modal.show();

                // Reset form when user clicks OK or modal hidden
                const okBtn = document.getElementById('bookingSuccessOk');
                okBtn.addEventListener('click', function () {
                    document.getElementById('bookingForm').reset();
                    resetFormUI();
                }, { once: true });

                modalEl.addEventListener('hidden.bs.modal', function () {
                    document.getElementById('bookingForm').reset();
                    resetFormUI();
                }, { once: true });
            } else {
                alert('Booking failed. Please try again.');
            }
        })
        .catch(err => {
            alert("Something went wrong. Please try again.");
            console.error(err);
        });
    });

    // Helper to reset UI parts (hide conditional sections) without re-registering event listeners
    function resetFormUI() {
        const ids = ['onewayFields1','returnFields1','arrivalFields1','departureFields1','dayServiceFields1'];
        ids.forEach(id => {
            const div = document.getElementById(id);
            if (!div) return;
            div.classList.add('d-none');
            const inputs = div.querySelectorAll('input, select, textarea');
            inputs.forEach(i => {
                i.setAttribute('disabled', 'disabled');
                i.removeAttribute('required');
            });
        });
        // reset rate and trip type
        const tripRateEl = document.getElementById('tripRate');
        if (tripRateEl) tripRateEl.innerText = 'AED 0';
        const rateInput = document.getElementById('rateInput');
        if (rateInput) rateInput.value = '';
        const tripType = document.getElementById('tripType1');
        if (tripType) tripType.value = '';

        // ensure the readonly trip request date stays current after reset
        const tripRequestDate = document.getElementById('tripRequestDate');
        if (tripRequestDate) {
            tripRequestDate.value = new Date().toISOString().split('T')[0];
            tripRequestDate.readOnly = true;
        }
    }
</script>

<!--email validation-->
<script>
    document.addEventListener("DOMContentLoaded", function () {

        const emailInput = document.getElementById("emailInput");
        const emailError = document.getElementById("emailError");
        const form = document.getElementById("bookingForm");

        // Gmail validation regex
        const gmailRegex = /^[a-zA-Z0-9._%+-]+@gmail\.com$/;

        function validateEmail() {
            const emailValue = emailInput.value.trim();

            if (emailValue === "") {
                emailError.textContent = "Email is required";
                emailError.classList.remove("d-none");
                return false;
            }

            if (!emailValue.includes("@")) {
                emailError.textContent = 'Email must contain "@" symbol';
                emailError.classList.remove("d-none");
                return false;
            }

            if (!emailValue.includes("gmail")) {
                emailError.textContent = 'Only Gmail addresses are allowed';
                emailError.classList.remove("d-none");
                return false;
            }

            if (!emailValue.endsWith(".com")) {
                emailError.textContent = 'Email must end with ".com"';
                emailError.classList.remove("d-none");
                return false;
            }

            if (!gmailRegex.test(emailValue)) {
                emailError.textContent = 'Invalid Gmail format (example@gmail.com)';
                emailError.classList.remove("d-none");
                return false;
            }

            // ✅ valid
            emailError.classList.add("d-none");
            return true;
        }

        // 🔹 When user leaves the email field
        emailInput.addEventListener("blur", validateEmail);

        // 🔹 When user presses Enter inside email field
        emailInput.addEventListener("keydown", function (e) {
            if (e.key === "Enter") {
                if (!validateEmail()) {
                    e.preventDefault();
                }
            }
        });

        // 🔹 On form submit
        form.addEventListener("submit", function (e) {
            if (!validateEmail()) {
                e.preventDefault();
                emailInput.focus();
            }
        });

    });
</script>

<!--travellers count validation - ) not allowed-->
<script>
    document.addEventListener("DOMContentLoaded", function () {

        const form = document.getElementById("bookingForm");

        // Custom validation for travellers count
        function validateTravellersCount() {
            const onewayCount = parseInt(document.getElementById("oneWayTravellersCount").value) || 0;
            const returnCount = parseInt(document.getElementById("returnTravellersCount").value) || 0;
            const arriveCount = parseInt(document.getElementById("arriveTravellersCount").value) || 0;
            const departCount = parseInt(document.getElementById("departTravellersCount").value) || 0;
            const dayTripCount = parseInt(document.getElementById("dayTripTravellersCount").value) || 0;

            // Check if any of the counts are less than 1
            if (onewayCount < 1 || returnCount < 1 || arriveCount < 1 || departCount < 1 || dayTripCount < 1) {
                alert("Number of passengers must be at least 1 for all trip types.");
                return false;
            }

            return true;
        }

        // On form submit
        form.addEventListener("submit", function (e) {
            if (!validateTravellersCount()) {
                e.preventDefault();
            }
        });

    });
</script>
